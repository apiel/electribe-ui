{"mappings":"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","sources":["src/index.js"],"sourcesContent":["// request MIDI access\nif (navigator.requestMIDIAccess) {\n    navigator\n        .requestMIDIAccess({\n            sysex: true,\n        })\n        .then(onMIDISuccess, onMIDIFailure);\n} else {\n    alert('No MIDI support in your browser.');\n}\n\nlet midi;\nlet midiOutput;\n\nfunction findElectribe2(sources) {\n    return [...sources.values()].find(({ name }) =>\n        name.startsWith('electribe2'),\n    );\n}\n\nfunction onMIDISuccess(midiAccess) {\n    midi = midiAccess;\n\n    const midiInput = findElectribe2(midi.inputs);\n    midiOutput = findElectribe2(midi.outputs);\n\n    if (!midiInput || !midiOutput) {\n        alert(\n            'Could not find electribe 2, check if device is properly connect.',\n        );\n    } else {\n        midiInput.onmidimessage = onMIDIMessage;\n        document.getElementById('input').innerHTML = midiInput.name;\n        document.getElementById('output').innerHTML = midiOutput.name;\n\n        queryCurrentPattern();\n    }\n}\n\nfunction queryCurrentPattern() {\n    midiOutput.send([240, 66, 48, 0, 1, 35, 16, 247]);\n}\n\nfunction onMIDIFailure(error) {\n    console.error(\n        \"No access to MIDI devices or your browser doesn't support WebMIDI API. Please use WebMIDIAPIShim \",\n        error,\n    );\n}\n\nfunction onMIDIMessage({ data }) {\n    // ignore with clock data[0] !== 248\n    if (data[0] === 248) {\n        return;\n    }\n\n    const headers = data.slice(0, 7).toString();\n    switch (headers) {\n        case '240,66,48,0,1,34,64': // e2s ?\n        case '240,66,48,0,1,35,64': // e2\n            console.log('Received pattern', data);\n            parsePattern(data);\n            break;\n\n        default:\n            console.log('MIDI data', headers, data);\n            break;\n    }\n}\n\nfunction parsePattern(rawData) {\n    const data = [...rawData];\n    const name = data\n        .slice(26, 43)\n        .filter((c, k) => c && k != 13) // data[39], here 13, is used for tempo ? kind of weird...\n        .map((c) => String.fromCharCode(c))\n        .join('');\n\n    const tempo = data[46] + data[48] * 256 + (data[39] ? 128 : 0);\n    console.log({\n        name,\n        tempo,\n    });\n}\n\ndocument.getElementById('note').innerHTML = Array(255)\n    .fill()\n    .map(\n        (_, key) =>\n            `<option value=\"${(key + 24) % 255}\">${(key + 24) % 255}</option>`,\n    )\n    .join('');\n\ndocument.getElementById('clear').onclick = () => {\n    document.getElementById('log').innerHTML = '';\n};\n\ndocument.getElementById('send').onclick = () => {\n    const { value: data } = document.getElementById('data');\n    const msg = JSON.parse(data);\n    console.log(`Send to ${output.name}:`, msg);\n    midiOutput.send(msg);\n};\n\ndocument.getElementById('sendHex').onclick = () => {\n    const { value: data } = document.getElementById('dataHex');\n    const msg = data\n        .replaceAll('0x', '')\n        .replaceAll(',', ' ')\n        .replace(/\\s\\s+/g, ' ') // replace multiple space to one\n        .split(' ')\n        .map((v) => parseInt(`0x${v}`));\n    console.log(`Send to ${output.name}:`, msg);\n    midiOutput.send(msg);\n};\n\n// Custom console.log\n\nrewireLoggingToElement(\n    () => document.getElementById('log'),\n    () => document.getElementById('log-container'),\n    true,\n);\n\nfunction rewireLoggingToElement(eleLocator, eleOverflowLocator, autoScroll) {\n    fixLoggingFunc('log');\n    fixLoggingFunc('debug');\n    fixLoggingFunc('warn');\n    fixLoggingFunc('error');\n    fixLoggingFunc('info');\n\n    function fixLoggingFunc(name) {\n        console['old' + name] = console[name];\n        console[name] = function (...arguments) {\n            const output = produceOutput(name, arguments);\n            const eleLog = eleLocator();\n\n            if (autoScroll) {\n                const eleContainerLog = eleOverflowLocator();\n                const isScrolledToBottom =\n                    eleContainerLog.scrollHeight -\n                        eleContainerLog.clientHeight <=\n                    eleContainerLog.scrollTop + 1;\n                eleLog.innerHTML += output + '<br>';\n                if (isScrolledToBottom) {\n                    eleContainerLog.scrollTop =\n                        eleContainerLog.scrollHeight -\n                        eleContainerLog.clientHeight;\n                }\n            } else {\n                eleLog.innerHTML += output + '<br>';\n            }\n\n            console['old' + name].apply(undefined, arguments);\n        };\n    }\n\n    function produceOutput(name, args) {\n        return args.reduce((output, arg) => {\n            return (\n                output +\n                '<span class=\"log-' +\n                typeof arg +\n                ' log-' +\n                name +\n                '\">' +\n                (typeof arg === 'object' ? JSON.stringify(arg) : arg) +\n                '</span>&nbsp;'\n            );\n        }, '');\n    }\n}\n"],"names":[],"version":3,"file":"index.579125c3.js.map","sourceRoot":"/__parcel_source_root/"}